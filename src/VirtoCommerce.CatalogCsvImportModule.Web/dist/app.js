!function(o){var t={};function r(e){if(t[e])return t[e].exports;var a=t[e]={i:e,l:!1,exports:{}};return o[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=o,r.c=t,r.d=function(o,t,e){r.o(o,t)||Object.defineProperty(o,t,{enumerable:!0,get:e})},r.r=function(o){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},r.t=function(o,t){if(1&t&&(o=r(o)),8&t)return o;if(4&t&&"object"==typeof o&&o&&o.__esModule)return o;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:o}),2&t&&"string"!=typeof o)for(var a in o)r.d(e,a,function(t){return o[t]}.bind(null,a));return e},r.n=function(o){var t=o&&o.__esModule?function(){return o.default}:function(){return o};return r.d(t,"a",t),t},r.o=function(o,t){return Object.prototype.hasOwnProperty.call(o,t)},r.p="",r(r.s=0)}([function(o,t,r){r(1),r(2),r(3),r(4),r(5),r(6),r(7),o.exports=r(8)},function(o,t){null!=AppDependencies&&AppDependencies.push("virtoCommerce.catalogCsvImportModule"),angular.module("virtoCommerce.catalogCsvImportModule",[]).config(["$stateProvider","$urlRouterProvider",function(o,t){}]).run(["$rootScope","platformWebApp.mainMenuService","platformWebApp.widgetService","platformWebApp.toolbarService","platformWebApp.pushNotificationTemplateResolver","platformWebApp.bladeNavigationService","$state","virtoCommerce.catalogModule.catalogImportService","virtoCommerce.catalogModule.catalogExportService",function(o,t,r,e,a,i,l,n,c){var p={priority:900,satisfy:function(o,t){return"menu"==t&&"CatalogCsvExport"==o.notifyType},template:"Modules/$(VirtoCommerce.CatalogCsvImportModule)/Scripts/blades/export/notifications/menuExport.tpl.html",action:function(o){l.go("workspace.pushNotificationsHistory",o)}};a.register(p);var m={priority:900,satisfy:function(o,t){return"history"==t&&"CatalogCsvExport"==o.notifyType},template:"Modules/$(VirtoCommerce.CatalogCsvImportModule)/Scripts/blades/export/notifications/historyExport.tpl.html",action:function(o){var t={id:"CatalogCsvExportDetail",title:"catalogCsvImportModule.blades.history.export.title",subtitle:"catalogCsvImportModule.blades.history.export.subtitle",template:"Modules/$(VirtoCommerce.CatalogCsvImportModule)/Scripts/blades/export/catalog-CSV-export.tpl.html",controller:"virtoCommerce.catalogCsvImportModule.catalogCSVexportController",notification:o};i.showBlade(t)}};a.register(m);var s={priority:900,satisfy:function(o,t){return"menu"==t&&"CatalogCsvImport"==o.notifyType},template:"Modules/$(VirtoCommerce.CatalogCsvImportModule)/Scripts/blades/import/notifications/menuImport.tpl.html",action:function(o){l.go("workspace.pushNotificationsHistory",o)}};a.register(s);var u={priority:900,satisfy:function(o,t){return"history"==t&&"CatalogCsvImport"==o.notifyType},template:"Modules/$(VirtoCommerce.CatalogCsvImportModule)/Scripts/blades/import/notifications/historyImport.tpl.html",action:function(o){var t={id:"CatalogCsvImportDetail",title:"catalogCsvImportModule.blades.history.import.title",subtitle:"catalogCsvImportModule.blades.history.import.title",template:"Modules/$(VirtoCommerce.CatalogCsvImportModule)/Scripts/blades/import/catalog-CSV-import.tpl.html",controller:"virtoCommerce.catalogCsvImportModule.catalogCSVimportController",notification:o};i.showBlade(t)}};a.register(u),n.register({name:"VirtoCommerce CSV import",description:"Native VirtoCommerce catalog data import from CSV",icon:"fa fa-file-archive-o",controller:"virtoCommerce.catalogCsvImportModule.catalogCSVimportWizardController",template:"Modules/$(VirtoCommerce.CatalogCsvImportModule)/Scripts/blades/import/wizard/catalog-CSV-import-wizard.tpl.html"}),c.register({name:"VirtoCommerce CSV export",description:"Native VirtoCommerce catalog data export to CSV",icon:"fa fa-file-archive-o",controller:"virtoCommerce.catalogCsvImportModule.catalogCSVexportController",template:"Modules/$(VirtoCommerce.CatalogCsvImportModule)/Scripts/blades/export/catalog-CSV-export.tpl.html"})}])},function(o,t){angular.module("virtoCommerce.catalogCsvImportModule").controller("virtoCommerce.catalogCsvImportModule.catalogCSVexportController",["$scope","platformWebApp.bladeNavigationService","virtoCommerce.catalogCsvImportModule.export","virtoCommerce.inventoryModule.fulfillments","virtoCommerce.pricingModule.pricelists",function(o,t,r,e,a){const i=o.blade;i.fulfilmentCenterId=void 0,i.pricelistId=void 0,i.isLoading=!1,i.title="catalogCsvImportModule.blades.catalog-CSV-export.title",i.titleValues={name:i.catalog?i.catalog.name:""},o.$on("new-notification-event",(function(o,t){i.notification&&t.id===i.notification.id&&angular.copy(t,i.notification)})),o.startExport=function(){r.run({catalogId:i.catalog.id,categoryIds:_.map(i.selectedCategories,(function(o){return o.id})),productIds:_.map(i.selectedProducts,(function(o){return o.id})),fulfilmentCenterId:i.fulfilmentCenterId,pricelistId:i.pricelistId},(function(o){i.notification=o}),(function(r){t.setError("Error "+r.status,o.blade)}))},o.setForm=function(t){o.formScope=t},a.search({take:1e3},(function(t){o.pricelists=_.filter(t.results,(function(o){return _.some(o.assignments,(function(o){return o.catalogId===i.catalog.id}))}))})),o.blade.headIcon="fa-file-archive-o",e.search({},(function(t){t.totalCount>0&&(o.fulfillmentCenters=t.results,i.fulfilmentCenterId=_.first(t.results).id)}),(function(r){t.setError("Error "+r.status,o.blade)}))}])},function(o,t){angular.module("virtoCommerce.catalogCsvImportModule").controller("virtoCommerce.catalogCsvImportModule.catalogCSVimportController",["$scope",function(o){var t=o.blade;t.isLoading=!1,t.title="catalogCsvImportModule.blades.catalog-CSV-import.title",o.$on("new-notification-event",(function(o,r){t.notification&&r.id===t.notification.id&&angular.copy(r,t.notification)})),o.setForm=function(t){o.formScope=t},o.bladeHeadIco="fa fa-file-archive-o"}])},function(o,t){angular.module("virtoCommerce.catalogCsvImportModule").controller("virtoCommerce.catalogCsvImportModule.catalogCSVimportWizardMappingStepController",["$scope","platformWebApp.bladeNavigationService",function(o,t){var r=o.blade;angular.forEach(o.blade.importConfiguration.propertyMaps,(function(t){o.$watch((function(o){return t.csvColumnName}),(function(o,t){if(t!=o){var e;if(o)-1!=(e=r.importConfiguration.propertyCsvColumns.indexOf(o))&&r.importConfiguration.propertyCsvColumns.splice(e,1);if(t)-1==(e=r.importConfiguration.propertyCsvColumns.indexOf(t))&&r.importConfiguration.propertyCsvColumns.push(t)}}))})),o.clearPropertyCsvColumns=function(){r.importConfiguration.propertyCsvColumns.length=0},o.removePropertyCsvColumn=function(o){var t=r.importConfiguration.propertyCsvColumns.indexOf(o);-1!=t&&r.importConfiguration.propertyCsvColumns.splice(t,1)},o.setForm=function(t){o.formScope=t},o.isValid=function(){return o.formScope&&o.formScope.$valid},o.saveChanges=function(){o.bladeClose()},r.isLoading=!1}])},function(o,t){angular.module("virtoCommerce.catalogCsvImportModule").controller("virtoCommerce.catalogCsvImportModule.catalogCSVimportWizardController",["$scope","$localStorage","platformWebApp.bladeNavigationService","FileUploader","virtoCommerce.catalogCsvImportModule.import",function(o,t,r,e,a){var i=o.blade;if(i.isLoading=!1,i.title="catalogCsvImportModule.wizards.catalog-CSV-import.title",i.subtitle="catalogCsvImportModule.wizards.catalog-CSV-import.subtitle",i.subtitleVales={name:i.catalog.name},o.columnDelimiters=[{name:"catalogCsvImportModule.wizards.catalog-CSV-import.labels.space",value:" "},{name:"catalogCsvImportModule.wizards.catalog-CSV-import.labels.comma",value:","},{name:"catalogCsvImportModule.wizards.catalog-CSV-import.labels.semicolon",value:";"},{name:"catalogCsvImportModule.wizards.catalog-CSV-import.labels.tab",value:"\t"}],!o.uploader){var l=o.uploader=new e({scope:o,headers:{Accept:"application/json"},url:"api/platform/assets?folderUrl=tmp",method:"POST",autoUpload:!0,removeAfterUpload:!0});l.onBeforeUploadItem=function(o){i.isLoading=!0},l.onSuccessItem=function(o,e,l,n){i.csvFileUrl=e[0].relativeUrl,a.getMappingConfiguration({fileUrl:i.csvFileUrl,delimiter:encodeURIComponent(i.columnDelimiter)},(function(o){t.lastKnownImportData&&t.lastKnownImportData.eTag===o.eTag&&angular.extend(o,t.lastKnownImportData),i.importConfiguration=o,i.isLoading=!1}),(function(o){r.setError("Error "+o.status,i)}))},l.onAfterAddingAll=function(o){r.setError(null,i)},l.onErrorItem=function(o,t,e,a){r.setError(o._file.name+" failed: "+(t.message?t.message:e),i)}}o.canMapColumns=function(){return i.importConfiguration&&o.formScope&&o.formScope.$valid},o.openMappingStep=function(){var o={id:"importMapping",importConfiguration:i.importConfiguration,title:"catalogCsvImportModule.wizards.catalog-CSV-import-wizard-mapping-step.title",subtitle:"catalogCsvImportModule.wizards.catalog-CSV-import-wizard-mapping-step.subtitle",controller:"virtoCommerce.catalogCsvImportModule.catalogCSVimportWizardMappingStepController",template:"Modules/$(VirtoCommerce.CatalogCsvImportModule)/Scripts/blades/import/wizard/catalog-CSV-import-wizard-mapping-step.tpl.html"};i.canImport=!0,r.showBlade(o,i)},o.startImport=function(){t.lastKnownImportData={eTag:i.importConfiguration.eTag,propertyMaps:i.importConfiguration.propertyMaps,propertyCsvColumns:i.importConfiguration.propertyCsvColumns};var e={configuration:i.importConfiguration,fileUrl:i.csvFileUrl,catalogId:i.catalog.id};a.run(e,(function(t){var e={id:"importProgress",catalog:i.catalog,notification:t,importConfiguration:i.importConfiguration,controller:"virtoCommerce.catalogCsvImportModule.catalogCSVimportController",template:"Modules/$(VirtoCommerce.CatalogCsvImportModule)/Scripts/blades/import/catalog-CSV-import.tpl.html"};o.$on("new-notification-event",(function(o,t){t&&t.id==e.notification.id&&(i.canImport=null!=t.finished)})),i.canImport=!1,r.showBlade(e,i)}),(function(o){r.setError("Error "+o.status,i)}))},o.setForm=function(t){o.formScope=t}}])},function(o,t){angular.module("virtoCommerce.catalogCsvImportModule").factory("virtoCommerce.catalogCsvImportModule.export",["$resource",function(o){return o("api/catalogcsvimport/export/:id",{id:"@id"},{run:{method:"POST",url:"api/catalogcsvimport/export",isArray:!1}})}])},function(o,t){angular.module("virtoCommerce.catalogCsvImportModule").factory("virtoCommerce.catalogCsvImportModule.import",["$resource",function(o){return o("api/catalogcsvimport/import",{},{getMappingConfiguration:{method:"GET",url:"api/catalogcsvimport/import/mappingconfiguration",isArray:!1},run:{method:"POST",url:"api/catalogcsvimport/import",isArray:!1}})}])},function(o,t){angular.module("virtoCommerce.catalogCsvImportModule").factory("virtoCommerce.catalogCsvImportModule.WebApi",["$resource",function(o){return o("api/catalogcsvimport")}])}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9WaXJ0b0NvbW1lcmNlLkNhdGFsb2dDc3ZJbXBvcnQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vVmlydG9Db21tZXJjZS5DYXRhbG9nQ3N2SW1wb3J0Ly4vU2NyaXB0cy92aXJ0b0NvbW1lcmNlLmNhdGFsb2dDc3ZJbXBvcnRNb2R1bGUuanMiLCJ3ZWJwYWNrOi8vVmlydG9Db21tZXJjZS5DYXRhbG9nQ3N2SW1wb3J0Ly4vU2NyaXB0cy9ibGFkZXMvZXhwb3J0L2NhdGFsb2ctQ1NWLWV4cG9ydC5qcyIsIndlYnBhY2s6Ly9WaXJ0b0NvbW1lcmNlLkNhdGFsb2dDc3ZJbXBvcnQvLi9TY3JpcHRzL2JsYWRlcy9pbXBvcnQvY2F0YWxvZy1DU1YtaW1wb3J0LmpzIiwid2VicGFjazovL1ZpcnRvQ29tbWVyY2UuQ2F0YWxvZ0NzdkltcG9ydC8uL1NjcmlwdHMvYmxhZGVzL2ltcG9ydC93aXphcmQvY2F0YWxvZy1DU1YtaW1wb3J0LXdpemFyZC1tYXBwaW5nLXN0ZXAuanMiLCJ3ZWJwYWNrOi8vVmlydG9Db21tZXJjZS5DYXRhbG9nQ3N2SW1wb3J0Ly4vU2NyaXB0cy9ibGFkZXMvaW1wb3J0L3dpemFyZC9jYXRhbG9nLUNTVi1pbXBvcnQtd2l6YXJkLmpzIiwid2VicGFjazovL1ZpcnRvQ29tbWVyY2UuQ2F0YWxvZ0NzdkltcG9ydC8uL1NjcmlwdHMvcmVzb3VyY2VzL2V4cG9ydC5qcyIsIndlYnBhY2s6Ly9WaXJ0b0NvbW1lcmNlLkNhdGFsb2dDc3ZJbXBvcnQvLi9TY3JpcHRzL3Jlc291cmNlcy9pbXBvcnQuanMiLCJ3ZWJwYWNrOi8vVmlydG9Db21tZXJjZS5DYXRhbG9nQ3N2SW1wb3J0Ly4vU2NyaXB0cy9yZXNvdXJjZXMvVmlydG9Db21tZXJjZS5DYXRhbG9nQ3N2SW1wb3J0TW9kdWxlLldlYkFwaS5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsInVuZGVmaW5lZCIsIkFwcERlcGVuZGVuY2llcyIsInB1c2giLCJhbmd1bGFyIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJydW4iLCIkcm9vdFNjb3BlIiwibWFpbk1lbnVTZXJ2aWNlIiwid2lkZ2V0U2VydmljZSIsInRvb2xiYXJTZXJ2aWNlIiwicHVzaE5vdGlmaWNhdGlvblRlbXBsYXRlUmVzb2x2ZXIiLCJibGFkZU5hdmlnYXRpb25TZXJ2aWNlIiwiJHN0YXRlIiwiY2F0YWxvZ0ltcG9ydFNlcnZpY2UiLCJjYXRhbG9nRXhwb3J0U2VydmljZSIsIm1lbnVFeHBvcnRUZW1wbGF0ZSIsInByaW9yaXR5Iiwic2F0aXNmeSIsIm5vdGlmeSIsInBsYWNlIiwibm90aWZ5VHlwZSIsInRlbXBsYXRlIiwiYWN0aW9uIiwiZ28iLCJyZWdpc3RlciIsImhpc3RvcnlFeHBvcnRUZW1wbGF0ZSIsImJsYWRlIiwiaWQiLCJ0aXRsZSIsInN1YnRpdGxlIiwiY29udHJvbGxlciIsIm5vdGlmaWNhdGlvbiIsInNob3dCbGFkZSIsIm1lbnVJbXBvcnRUZW1wbGF0ZSIsImhpc3RvcnlJbXBvcnRUZW1wbGF0ZSIsImRlc2NyaXB0aW9uIiwiaWNvbiIsIiRzY29wZSIsImV4cG9ydFJlc291cnNlIiwiZnVsZmlsbG1lbnRzIiwicHJpY2VsaXN0cyIsImZ1bGZpbG1lbnRDZW50ZXJJZCIsInByaWNlbGlzdElkIiwiaXNMb2FkaW5nIiwidGl0bGVWYWx1ZXMiLCJjYXRhbG9nIiwiJG9uIiwiZXZlbnQiLCJjb3B5Iiwic3RhcnRFeHBvcnQiLCJjYXRhbG9nSWQiLCJjYXRlZ29yeUlkcyIsIl8iLCJtYXAiLCJzZWxlY3RlZENhdGVnb3JpZXMiLCJ4IiwicHJvZHVjdElkcyIsInNlbGVjdGVkUHJvZHVjdHMiLCJkYXRhIiwiZXJyb3IiLCJzZXRFcnJvciIsInN0YXR1cyIsInNldEZvcm0iLCJmb3JtIiwiZm9ybVNjb3BlIiwic2VhcmNoIiwidGFrZSIsInJlc3VsdCIsImZpbHRlciIsInJlc3VsdHMiLCJzb21lIiwiYXNzaWdubWVudHMiLCJ5IiwiaGVhZEljb24iLCJ0b3RhbENvdW50IiwiZnVsZmlsbG1lbnRDZW50ZXJzIiwiZmlyc3QiLCJibGFkZUhlYWRJY28iLCJmb3JFYWNoIiwiaW1wb3J0Q29uZmlndXJhdGlvbiIsInByb3BlcnR5TWFwcyIsIiR3YXRjaCIsImNzdkNvbHVtbk5hbWUiLCJuZXdWYWx1ZSIsIm9sZFZhbHVlIiwiaW5kZXgiLCJwcm9wZXJ0eUNzdkNvbHVtbnMiLCJpbmRleE9mIiwic3BsaWNlIiwiY2xlYXJQcm9wZXJ0eUNzdkNvbHVtbnMiLCJsZW5ndGgiLCJyZW1vdmVQcm9wZXJ0eUNzdkNvbHVtbiIsImNvbHVtbiIsImlzVmFsaWQiLCIkdmFsaWQiLCJzYXZlQ2hhbmdlcyIsImJsYWRlQ2xvc2UiLCIkbG9jYWxTdG9yYWdlIiwiRmlsZVVwbG9hZGVyIiwiaW1wb3J0UmVzb3VyY2UiLCJzdWJ0aXRsZVZhbGVzIiwiY29sdW1uRGVsaW1pdGVycyIsInVwbG9hZGVyIiwic2NvcGUiLCJoZWFkZXJzIiwiQWNjZXB0IiwidXJsIiwibWV0aG9kIiwiYXV0b1VwbG9hZCIsInJlbW92ZUFmdGVyVXBsb2FkIiwib25CZWZvcmVVcGxvYWRJdGVtIiwiZmlsZUl0ZW0iLCJvblN1Y2Nlc3NJdGVtIiwiYXNzZXQiLCJjc3ZGaWxlVXJsIiwicmVsYXRpdmVVcmwiLCJnZXRNYXBwaW5nQ29uZmlndXJhdGlvbiIsImZpbGVVcmwiLCJkZWxpbWl0ZXIiLCJlbmNvZGVVUklDb21wb25lbnQiLCJjb2x1bW5EZWxpbWl0ZXIiLCJsYXN0S25vd25JbXBvcnREYXRhIiwiZVRhZyIsImV4dGVuZCIsIm9uQWZ0ZXJBZGRpbmdBbGwiLCJhZGRlZEl0ZW1zIiwib25FcnJvckl0ZW0iLCJpdGVtIiwicmVzcG9uc2UiLCJfZmlsZSIsIm1lc3NhZ2UiLCJjYW5NYXBDb2x1bW5zIiwib3Blbk1hcHBpbmdTdGVwIiwibmV3QmxhZGUiLCJjYW5JbXBvcnQiLCJzdGFydEltcG9ydCIsImV4cG9ydEluZm8iLCJjb25maWd1cmF0aW9uIiwiZmluaXNoZWQiLCJmYWN0b3J5IiwiJHJlc291cmNlIiwiaXNBcnJheSJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0wsS0FLaEVaLEVBQW9Ca0IsRUFBSSxTQUFTaEIsR0FDWCxvQkFBWGlCLFFBQTBCQSxPQUFPQyxhQUMxQ04sT0FBT0MsZUFBZWIsRUFBU2lCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RFAsT0FBT0MsZUFBZWIsRUFBUyxhQUFjLENBQUVtQixPQUFPLEtBUXZEckIsRUFBb0JzQixFQUFJLFNBQVNELEVBQU9F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LE9BQU8sd0NBQ2Y4SyxRQUFRLDhDQUErQyxDQUFDLFlBQWEsU0FBVUMsR0FFNUUsT0FBT0EsRUFBVSw4QkFBK0IsR0FBSSxDQUNoRHhCLHdCQUF5QixDQUFFVCxPQUFRLE1BQU9ELElBQUssbURBQW9EbUMsU0FBUyxHQUM1R3hJLElBQUssQ0FBRXNHLE9BQVEsT0FBUUQsSUFBSyw4QkFBK0JtQyxTQUFTLFMsY0NMM0U1SSxRQUFRcEMsT0FBTyx3Q0FDZjhLLFFBQVEsOENBQStDLENBQUMsWUFBYSxTQUFVQyxHQUM1RSxPQUFPQSxFQUFVIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsIu+7vy8vQ2FsbCB0aGlzIHRvIHJlZ2lzdGVyIG91ciBtb2R1bGUgdG8gbWFpbiBhcHBsaWNhdGlvblxyXG52YXIgbW9kdWxlVGVtcGxhdGVOYW1lID0gXCJ2aXJ0b0NvbW1lcmNlLmNhdGFsb2dDc3ZJbXBvcnRNb2R1bGVcIjtcclxuXHJcbmlmIChBcHBEZXBlbmRlbmNpZXMgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICBBcHBEZXBlbmRlbmNpZXMucHVzaChtb2R1bGVUZW1wbGF0ZU5hbWUpO1xyXG59XHJcblxyXG5hbmd1bGFyLm1vZHVsZShtb2R1bGVUZW1wbGF0ZU5hbWUsIFtdKVxyXG4uY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJyxcclxuICAgIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XHJcbiAgICB9XHJcbl0pXHJcbiAgICAucnVuKFsnJHJvb3RTY29wZScsICdwbGF0Zm9ybVdlYkFwcC5tYWluTWVudVNlcnZpY2UnLCAncGxhdGZvcm1XZWJBcHAud2lkZ2V0U2VydmljZScsICdwbGF0Zm9ybVdlYkFwcC50b29sYmFyU2VydmljZScsICdwbGF0Zm9ybVdlYkFwcC5wdXNoTm90aWZpY2F0aW9uVGVtcGxhdGVSZXNvbHZlcicsICdwbGF0Zm9ybVdlYkFwcC5ibGFkZU5hdmlnYXRpb25TZXJ2aWNlJywgJyRzdGF0ZScsICd2aXJ0b0NvbW1lcmNlLmNhdGFsb2dNb2R1bGUuY2F0YWxvZ0ltcG9ydFNlcnZpY2UnLCAndmlydG9Db21tZXJjZS5jYXRhbG9nTW9kdWxlLmNhdGFsb2dFeHBvcnRTZXJ2aWNlJyxcclxuICAgICAgICBmdW5jdGlvbiAoJHJvb3RTY29wZSwgbWFpbk1lbnVTZXJ2aWNlLCB3aWRnZXRTZXJ2aWNlLCB0b29sYmFyU2VydmljZSwgcHVzaE5vdGlmaWNhdGlvblRlbXBsYXRlUmVzb2x2ZXIsIGJsYWRlTmF2aWdhdGlvblNlcnZpY2UsICRzdGF0ZSwgY2F0YWxvZ0ltcG9ydFNlcnZpY2UsIGNhdGFsb2dFeHBvcnRTZXJ2aWNlKSB7XHJcblxyXG4gICAgICAgIC8vTk9USUZJQ0FUSU9OU1xyXG4gICAgICAgIC8vRXhwb3J0XHJcbiAgICAgICAgdmFyIG1lbnVFeHBvcnRUZW1wbGF0ZSA9XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBwcmlvcml0eTogOTAwLFxyXG4gICAgICAgICAgICBzYXRpc2Z5OiBmdW5jdGlvbiAobm90aWZ5LCBwbGFjZSkgeyByZXR1cm4gcGxhY2UgPT0gJ21lbnUnICYmIG5vdGlmeS5ub3RpZnlUeXBlID09ICdDYXRhbG9nQ3N2RXhwb3J0JzsgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICdNb2R1bGVzLyQoVmlydG9Db21tZXJjZS5DYXRhbG9nQ3N2SW1wb3J0TW9kdWxlKS9TY3JpcHRzL2JsYWRlcy9leHBvcnQvbm90aWZpY2F0aW9ucy9tZW51RXhwb3J0LnRwbC5odG1sJyxcclxuICAgICAgICAgICAgYWN0aW9uOiBmdW5jdGlvbiAobm90aWZ5KSB7ICRzdGF0ZS5nbygnd29ya3NwYWNlLnB1c2hOb3RpZmljYXRpb25zSGlzdG9yeScsIG5vdGlmeSkgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcHVzaE5vdGlmaWNhdGlvblRlbXBsYXRlUmVzb2x2ZXIucmVnaXN0ZXIobWVudUV4cG9ydFRlbXBsYXRlKTtcclxuXHJcbiAgICAgICAgdmFyIGhpc3RvcnlFeHBvcnRUZW1wbGF0ZSA9XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBwcmlvcml0eTogOTAwLFxyXG4gICAgICAgICAgICBzYXRpc2Z5OiBmdW5jdGlvbiAobm90aWZ5LCBwbGFjZSkgeyByZXR1cm4gcGxhY2UgPT0gJ2hpc3RvcnknICYmIG5vdGlmeS5ub3RpZnlUeXBlID09ICdDYXRhbG9nQ3N2RXhwb3J0JzsgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICdNb2R1bGVzLyQoVmlydG9Db21tZXJjZS5DYXRhbG9nQ3N2SW1wb3J0TW9kdWxlKS9TY3JpcHRzL2JsYWRlcy9leHBvcnQvbm90aWZpY2F0aW9ucy9oaXN0b3J5RXhwb3J0LnRwbC5odG1sJyxcclxuICAgICAgICAgICAgYWN0aW9uOiBmdW5jdGlvbiAobm90aWZ5KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYmxhZGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICdDYXRhbG9nQ3N2RXhwb3J0RGV0YWlsJyxcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ2NhdGFsb2dDc3ZJbXBvcnRNb2R1bGUuYmxhZGVzLmhpc3RvcnkuZXhwb3J0LnRpdGxlJyxcclxuICAgICAgICAgICAgICAgICAgICBzdWJ0aXRsZTogJ2NhdGFsb2dDc3ZJbXBvcnRNb2R1bGUuYmxhZGVzLmhpc3RvcnkuZXhwb3J0LnN1YnRpdGxlJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJ01vZHVsZXMvJChWaXJ0b0NvbW1lcmNlLkNhdGFsb2dDc3ZJbXBvcnRNb2R1bGUpL1NjcmlwdHMvYmxhZGVzL2V4cG9ydC9jYXRhbG9nLUNTVi1leHBvcnQudHBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd2aXJ0b0NvbW1lcmNlLmNhdGFsb2dDc3ZJbXBvcnRNb2R1bGUuY2F0YWxvZ0NTVmV4cG9ydENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbjogbm90aWZ5XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgYmxhZGVOYXZpZ2F0aW9uU2VydmljZS5zaG93QmxhZGUoYmxhZGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBwdXNoTm90aWZpY2F0aW9uVGVtcGxhdGVSZXNvbHZlci5yZWdpc3RlcihoaXN0b3J5RXhwb3J0VGVtcGxhdGUpO1xyXG5cclxuICAgICAgICAvL0ltcG9ydFxyXG4gICAgICAgIHZhciBtZW51SW1wb3J0VGVtcGxhdGUgPVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcHJpb3JpdHk6IDkwMCxcclxuICAgICAgICAgICAgc2F0aXNmeTogZnVuY3Rpb24gKG5vdGlmeSwgcGxhY2UpIHsgcmV0dXJuIHBsYWNlID09ICdtZW51JyAmJiBub3RpZnkubm90aWZ5VHlwZSA9PSAnQ2F0YWxvZ0NzdkltcG9ydCc7IH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnTW9kdWxlcy8kKFZpcnRvQ29tbWVyY2UuQ2F0YWxvZ0NzdkltcG9ydE1vZHVsZSkvU2NyaXB0cy9ibGFkZXMvaW1wb3J0L25vdGlmaWNhdGlvbnMvbWVudUltcG9ydC50cGwuaHRtbCcsXHJcbiAgICAgICAgICAgIGFjdGlvbjogZnVuY3Rpb24gKG5vdGlmeSkgeyAkc3RhdGUuZ28oJ3dvcmtzcGFjZS5wdXNoTm90aWZpY2F0aW9uc0hpc3RvcnknLCBub3RpZnkpIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHB1c2hOb3RpZmljYXRpb25UZW1wbGF0ZVJlc29sdmVyLnJlZ2lzdGVyKG1lbnVJbXBvcnRUZW1wbGF0ZSk7XHJcblxyXG4gICAgICAgIHZhciBoaXN0b3J5SW1wb3J0VGVtcGxhdGUgPVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcHJpb3JpdHk6IDkwMCxcclxuICAgICAgICAgICAgc2F0aXNmeTogZnVuY3Rpb24gKG5vdGlmeSwgcGxhY2UpIHsgcmV0dXJuIHBsYWNlID09ICdoaXN0b3J5JyAmJiBub3RpZnkubm90aWZ5VHlwZSA9PSAnQ2F0YWxvZ0NzdkltcG9ydCc7IH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnTW9kdWxlcy8kKFZpcnRvQ29tbWVyY2UuQ2F0YWxvZ0NzdkltcG9ydE1vZHVsZSkvU2NyaXB0cy9ibGFkZXMvaW1wb3J0L25vdGlmaWNhdGlvbnMvaGlzdG9yeUltcG9ydC50cGwuaHRtbCcsXHJcbiAgICAgICAgICAgIGFjdGlvbjogZnVuY3Rpb24gKG5vdGlmeSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGJsYWRlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiAnQ2F0YWxvZ0NzdkltcG9ydERldGFpbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdjYXRhbG9nQ3N2SW1wb3J0TW9kdWxlLmJsYWRlcy5oaXN0b3J5LmltcG9ydC50aXRsZScsXHJcbiAgICAgICAgICAgICAgICAgICAgc3VidGl0bGU6ICdjYXRhbG9nQ3N2SW1wb3J0TW9kdWxlLmJsYWRlcy5oaXN0b3J5LmltcG9ydC50aXRsZScsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6ICdNb2R1bGVzLyQoVmlydG9Db21tZXJjZS5DYXRhbG9nQ3N2SW1wb3J0TW9kdWxlKS9TY3JpcHRzL2JsYWRlcy9pbXBvcnQvY2F0YWxvZy1DU1YtaW1wb3J0LnRwbC5odG1sJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAndmlydG9Db21tZXJjZS5jYXRhbG9nQ3N2SW1wb3J0TW9kdWxlLmNhdGFsb2dDU1ZpbXBvcnRDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb246IG5vdGlmeVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGJsYWRlTmF2aWdhdGlvblNlcnZpY2Uuc2hvd0JsYWRlKGJsYWRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcHVzaE5vdGlmaWNhdGlvblRlbXBsYXRlUmVzb2x2ZXIucmVnaXN0ZXIoaGlzdG9yeUltcG9ydFRlbXBsYXRlKTtcclxuXHJcbiAgICAgICAgLy8gSU1QT1JUIC8gRVhQT1JUXHJcbiAgICAgICAgY2F0YWxvZ0ltcG9ydFNlcnZpY2UucmVnaXN0ZXIoe1xyXG4gICAgICAgICAgICBuYW1lOiAnVmlydG9Db21tZXJjZSBDU1YgaW1wb3J0JyxcclxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICdOYXRpdmUgVmlydG9Db21tZXJjZSBjYXRhbG9nIGRhdGEgaW1wb3J0IGZyb20gQ1NWJyxcclxuICAgICAgICAgICAgaWNvbjogJ2ZhIGZhLWZpbGUtYXJjaGl2ZS1vJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ3ZpcnRvQ29tbWVyY2UuY2F0YWxvZ0NzdkltcG9ydE1vZHVsZS5jYXRhbG9nQ1NWaW1wb3J0V2l6YXJkQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnTW9kdWxlcy8kKFZpcnRvQ29tbWVyY2UuQ2F0YWxvZ0NzdkltcG9ydE1vZHVsZSkvU2NyaXB0cy9ibGFkZXMvaW1wb3J0L3dpemFyZC9jYXRhbG9nLUNTVi1pbXBvcnQtd2l6YXJkLnRwbC5odG1sJ1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjYXRhbG9nRXhwb3J0U2VydmljZS5yZWdpc3Rlcih7XHJcbiAgICAgICAgICAgIG5hbWU6ICdWaXJ0b0NvbW1lcmNlIENTViBleHBvcnQnLFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJ05hdGl2ZSBWaXJ0b0NvbW1lcmNlIGNhdGFsb2cgZGF0YSBleHBvcnQgdG8gQ1NWJyxcclxuICAgICAgICAgICAgaWNvbjogJ2ZhIGZhLWZpbGUtYXJjaGl2ZS1vJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ3ZpcnRvQ29tbWVyY2UuY2F0YWxvZ0NzdkltcG9ydE1vZHVsZS5jYXRhbG9nQ1NWZXhwb3J0Q29udHJvbGxlcicsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnTW9kdWxlcy8kKFZpcnRvQ29tbWVyY2UuQ2F0YWxvZ0NzdkltcG9ydE1vZHVsZSkvU2NyaXB0cy9ibGFkZXMvZXhwb3J0L2NhdGFsb2ctQ1NWLWV4cG9ydC50cGwuaHRtbCdcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCd2aXJ0b0NvbW1lcmNlLmNhdGFsb2dDc3ZJbXBvcnRNb2R1bGUnKVxyXG4uY29udHJvbGxlcigndmlydG9Db21tZXJjZS5jYXRhbG9nQ3N2SW1wb3J0TW9kdWxlLmNhdGFsb2dDU1ZleHBvcnRDb250cm9sbGVyJywgWyckc2NvcGUnLCAncGxhdGZvcm1XZWJBcHAuYmxhZGVOYXZpZ2F0aW9uU2VydmljZScsICd2aXJ0b0NvbW1lcmNlLmNhdGFsb2dDc3ZJbXBvcnRNb2R1bGUuZXhwb3J0JywgJ3ZpcnRvQ29tbWVyY2UuaW52ZW50b3J5TW9kdWxlLmZ1bGZpbGxtZW50cycsICd2aXJ0b0NvbW1lcmNlLnByaWNpbmdNb2R1bGUucHJpY2VsaXN0cycsXHJcbiAgICBmdW5jdGlvbiAoJHNjb3BlLCBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLCBleHBvcnRSZXNvdXJzZSwgZnVsZmlsbG1lbnRzLCBwcmljZWxpc3RzKSB7XHJcblxyXG4gICAgICAgIGNvbnN0IGJsYWRlID0gJHNjb3BlLmJsYWRlO1xyXG4gICAgICAgIGJsYWRlLmZ1bGZpbG1lbnRDZW50ZXJJZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICBibGFkZS5wcmljZWxpc3RJZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICBibGFkZS5pc0xvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICBibGFkZS50aXRsZSA9ICdjYXRhbG9nQ3N2SW1wb3J0TW9kdWxlLmJsYWRlcy5jYXRhbG9nLUNTVi1leHBvcnQudGl0bGUnO1xyXG4gICAgICAgIGJsYWRlLnRpdGxlVmFsdWVzID0geyBuYW1lOiBibGFkZS5jYXRhbG9nID8gYmxhZGUuY2F0YWxvZy5uYW1lIDogJycgfTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaW5pdGlhbGl6ZUJsYWRlKCkge1xyXG4gICAgICAgICAgICBmdWxmaWxsbWVudHMuc2VhcmNoKHt9LCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudG90YWxDb3VudCA+IDApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZnVsZmlsbG1lbnRDZW50ZXJzID0gZGF0YS5yZXN1bHRzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBibGFkZS5mdWxmaWxtZW50Q2VudGVySWQgPSBfLmZpcnN0KGRhdGEucmVzdWx0cykuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChlcnJvcikgeyBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNldEVycm9yKCdFcnJvciAnICsgZXJyb3Iuc3RhdHVzLCAkc2NvcGUuYmxhZGUpOyB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oXCJuZXctbm90aWZpY2F0aW9uLWV2ZW50XCIsIGZ1bmN0aW9uIChldmVudCwgbm90aWZpY2F0aW9uKSB7XHJcbiAgICAgICAgICAgIGlmIChibGFkZS5ub3RpZmljYXRpb24gJiYgbm90aWZpY2F0aW9uLmlkID09PSBibGFkZS5ub3RpZmljYXRpb24uaWQpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuY29weShub3RpZmljYXRpb24sIGJsYWRlLm5vdGlmaWNhdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnN0YXJ0RXhwb3J0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBleHBvcnRSZXNvdXJzZS5ydW4oe1xyXG4gICAgICAgICAgICAgICAgY2F0YWxvZ0lkOiBibGFkZS5jYXRhbG9nLmlkLFxyXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnlJZHM6IF8ubWFwKGJsYWRlLnNlbGVjdGVkQ2F0ZWdvcmllcywgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguaWQgfSksXHJcbiAgICAgICAgICAgICAgICBwcm9kdWN0SWRzOiBfLm1hcChibGFkZS5zZWxlY3RlZFByb2R1Y3RzLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5pZCB9KSxcclxuICAgICAgICAgICAgICAgIGZ1bGZpbG1lbnRDZW50ZXJJZDogYmxhZGUuZnVsZmlsbWVudENlbnRlcklkLFxyXG4gICAgICAgICAgICAgICAgcHJpY2VsaXN0SWQ6IGJsYWRlLnByaWNlbGlzdElkXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7IGJsYWRlLm5vdGlmaWNhdGlvbiA9IGRhdGE7IH0sXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIChlcnJvcikgeyBibGFkZU5hdmlnYXRpb25TZXJ2aWNlLnNldEVycm9yKCdFcnJvciAnICsgZXJyb3Iuc3RhdHVzLCAkc2NvcGUuYmxhZGUpOyB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuc2V0Rm9ybSA9IGZ1bmN0aW9uIChmb3JtKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5mb3JtU2NvcGUgPSBmb3JtO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHByaWNlbGlzdHMuc2VhcmNoKHsgdGFrZTogMTAwMCB9LCBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICRzY29wZS5wcmljZWxpc3RzID0gXy5maWx0ZXIocmVzdWx0LnJlc3VsdHMsXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoeCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoeC5hc3NpZ25tZW50cyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB5LmNhdGFsb2dJZCA9PT0gYmxhZGUuY2F0YWxvZy5pZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICRzY29wZS5ibGFkZS5oZWFkSWNvbiA9ICdmYS1maWxlLWFyY2hpdmUtbyc7XHJcblxyXG4gICAgICAgIGluaXRpYWxpemVCbGFkZSgpO1xyXG4gICAgfV0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgndmlydG9Db21tZXJjZS5jYXRhbG9nQ3N2SW1wb3J0TW9kdWxlJylcclxuLmNvbnRyb2xsZXIoJ3ZpcnRvQ29tbWVyY2UuY2F0YWxvZ0NzdkltcG9ydE1vZHVsZS5jYXRhbG9nQ1NWaW1wb3J0Q29udHJvbGxlcicsIFsnJHNjb3BlJywgXHJcbiAgICBmdW5jdGlvbiAoJHNjb3BlKSB7XHJcblxyXG4gICAgICAgIHZhciBibGFkZSA9ICRzY29wZS5ibGFkZTtcclxuICAgICAgICBibGFkZS5pc0xvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICBibGFkZS50aXRsZSA9ICdjYXRhbG9nQ3N2SW1wb3J0TW9kdWxlLmJsYWRlcy5jYXRhbG9nLUNTVi1pbXBvcnQudGl0bGUnO1xyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKFwibmV3LW5vdGlmaWNhdGlvbi1ldmVudFwiLCBmdW5jdGlvbiAoZXZlbnQsIG5vdGlmaWNhdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoYmxhZGUubm90aWZpY2F0aW9uICYmIG5vdGlmaWNhdGlvbi5pZCA9PT0gYmxhZGUubm90aWZpY2F0aW9uLmlkKSB7XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmNvcHkobm90aWZpY2F0aW9uLCBibGFkZS5ub3RpZmljYXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICRzY29wZS5zZXRGb3JtID0gZnVuY3Rpb24oZm9ybSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9ybVNjb3BlID0gZm9ybTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuYmxhZGVIZWFkSWNvID0gJ2ZhIGZhLWZpbGUtYXJjaGl2ZS1vJztcclxuICAgIH1dKTtcclxuIiwi77u/YW5ndWxhci5tb2R1bGUoJ3ZpcnRvQ29tbWVyY2UuY2F0YWxvZ0NzdkltcG9ydE1vZHVsZScpXHJcbi5jb250cm9sbGVyKCd2aXJ0b0NvbW1lcmNlLmNhdGFsb2dDc3ZJbXBvcnRNb2R1bGUuY2F0YWxvZ0NTVmltcG9ydFdpemFyZE1hcHBpbmdTdGVwQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJ3BsYXRmb3JtV2ViQXBwLmJsYWRlTmF2aWdhdGlvblNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCBibGFkZU5hdmlnYXRpb25TZXJ2aWNlKSB7XHJcblx0dmFyIGJsYWRlID0gJHNjb3BlLmJsYWRlO1xyXG5cdFxyXG5cclxuXHQvL05lZWQgYXV0b21hdGljYWxseSB0cmFja2luZyBcclxuXHRhbmd1bGFyLmZvckVhY2goJHNjb3BlLmJsYWRlLmltcG9ydENvbmZpZ3VyYXRpb24ucHJvcGVydHlNYXBzLCBmdW5jdGlvbiAoeCkge1xyXG5cdFx0JHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoJHNjb3BlKSB7IHJldHVybiB4LmNzdkNvbHVtbk5hbWUgfSwgZnVuY3Rpb24gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xyXG5cdFx0XHRpZiAob2xkVmFsdWUgIT0gbmV3VmFsdWUpIHtcclxuXHRcdFx0XHRpZiAobmV3VmFsdWUpIHtcclxuXHRcdFx0XHRcdHZhciBpbmRleCA9IGJsYWRlLmltcG9ydENvbmZpZ3VyYXRpb24ucHJvcGVydHlDc3ZDb2x1bW5zLmluZGV4T2YobmV3VmFsdWUpO1xyXG5cdFx0XHRcdFx0aWYgKGluZGV4ICE9IC0xKSB7XHJcblx0XHRcdFx0XHRcdGJsYWRlLmltcG9ydENvbmZpZ3VyYXRpb24ucHJvcGVydHlDc3ZDb2x1bW5zLnNwbGljZShpbmRleCwgMSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmIChvbGRWYWx1ZSkge1xyXG5cdFx0XHRcdFx0dmFyIGluZGV4ID0gYmxhZGUuaW1wb3J0Q29uZmlndXJhdGlvbi5wcm9wZXJ0eUNzdkNvbHVtbnMuaW5kZXhPZihvbGRWYWx1ZSk7XHJcblx0XHRcdFx0XHRpZiAoaW5kZXggPT0gLTEpIHtcclxuXHRcdFx0XHRcdFx0YmxhZGUuaW1wb3J0Q29uZmlndXJhdGlvbi5wcm9wZXJ0eUNzdkNvbHVtbnMucHVzaChvbGRWYWx1ZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9KTtcclxuXHJcblx0JHNjb3BlLmNsZWFyUHJvcGVydHlDc3ZDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0YmxhZGUuaW1wb3J0Q29uZmlndXJhdGlvbi5wcm9wZXJ0eUNzdkNvbHVtbnMubGVuZ3RoID0gMDtcclxuXHJcblx0fTtcclxuXHJcblx0JHNjb3BlLnJlbW92ZVByb3BlcnR5Q3N2Q29sdW1uID0gZnVuY3Rpb24gKGNvbHVtbikge1xyXG5cdFx0dmFyIGluZGV4ID0gYmxhZGUuaW1wb3J0Q29uZmlndXJhdGlvbi5wcm9wZXJ0eUNzdkNvbHVtbnMuaW5kZXhPZihjb2x1bW4pO1xyXG5cdFx0aWYgKGluZGV4ICE9IC0xKSB7XHJcblx0XHRcdGJsYWRlLmltcG9ydENvbmZpZ3VyYXRpb24ucHJvcGVydHlDc3ZDb2x1bW5zLnNwbGljZShpbmRleCwgMSk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcbiAgICAkc2NvcGUuc2V0Rm9ybSA9IGZ1bmN0aW9uIChmb3JtKSB7XHJcbiAgICAgICAgJHNjb3BlLmZvcm1TY29wZSA9IGZvcm07XHJcbiAgICB9XHJcblxyXG4gICAgJHNjb3BlLmlzVmFsaWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBcdHJldHVybiAkc2NvcGUuZm9ybVNjb3BlICYmICRzY29wZS5mb3JtU2NvcGUuJHZhbGlkO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuc2F2ZUNoYW5nZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBcdCRzY29wZS5ibGFkZUNsb3NlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGJsYWRlLmlzTG9hZGluZyA9IGZhbHNlO1xyXG59XSk7XHJcblxyXG5cclxuIiwi77u/YW5ndWxhci5tb2R1bGUoJ3ZpcnRvQ29tbWVyY2UuY2F0YWxvZ0NzdkltcG9ydE1vZHVsZScpXHJcbi5jb250cm9sbGVyKCd2aXJ0b0NvbW1lcmNlLmNhdGFsb2dDc3ZJbXBvcnRNb2R1bGUuY2F0YWxvZ0NTVmltcG9ydFdpemFyZENvbnRyb2xsZXInLCBbJyRzY29wZScsICckbG9jYWxTdG9yYWdlJywgJ3BsYXRmb3JtV2ViQXBwLmJsYWRlTmF2aWdhdGlvblNlcnZpY2UnLCAnRmlsZVVwbG9hZGVyJywgJ3ZpcnRvQ29tbWVyY2UuY2F0YWxvZ0NzdkltcG9ydE1vZHVsZS5pbXBvcnQnLFxyXG4gICAgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2FsU3RvcmFnZSwgYmxhZGVOYXZpZ2F0aW9uU2VydmljZSwgRmlsZVVwbG9hZGVyLCBpbXBvcnRSZXNvdXJjZSkge1xyXG5cclxuICAgICAgICB2YXIgYmxhZGUgPSAkc2NvcGUuYmxhZGU7XHJcbiAgICAgICAgYmxhZGUuaXNMb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgYmxhZGUudGl0bGUgPSAnY2F0YWxvZ0NzdkltcG9ydE1vZHVsZS53aXphcmRzLmNhdGFsb2ctQ1NWLWltcG9ydC50aXRsZSc7XHJcbiAgICAgICAgYmxhZGUuc3VidGl0bGUgPSAnY2F0YWxvZ0NzdkltcG9ydE1vZHVsZS53aXphcmRzLmNhdGFsb2ctQ1NWLWltcG9ydC5zdWJ0aXRsZSc7XHJcbiAgICAgICAgYmxhZGUuc3VidGl0bGVWYWxlcyA9IHsgbmFtZTogYmxhZGUuY2F0YWxvZy5uYW1lIH07XHJcblxyXG4gICAgICAgICRzY29wZS5jb2x1bW5EZWxpbWl0ZXJzID0gW1xyXG4gICAgICAgICAgICB7IG5hbWU6IFwiY2F0YWxvZ0NzdkltcG9ydE1vZHVsZS53aXphcmRzLmNhdGFsb2ctQ1NWLWltcG9ydC5sYWJlbHMuc3BhY2VcIiwgdmFsdWU6IFwiIFwiIH0sXHJcbiAgICAgICAgICAgIHsgbmFtZTogXCJjYXRhbG9nQ3N2SW1wb3J0TW9kdWxlLndpemFyZHMuY2F0YWxvZy1DU1YtaW1wb3J0LmxhYmVscy5jb21tYVwiLCB2YWx1ZTogXCIsXCIgfSxcclxuICAgICAgICAgICAgeyBuYW1lOiBcImNhdGFsb2dDc3ZJbXBvcnRNb2R1bGUud2l6YXJkcy5jYXRhbG9nLUNTVi1pbXBvcnQubGFiZWxzLnNlbWljb2xvblwiLCB2YWx1ZTogXCI7XCIgfSxcclxuICAgICAgICAgICAgeyBuYW1lOiBcImNhdGFsb2dDc3ZJbXBvcnRNb2R1bGUud2l6YXJkcy5jYXRhbG9nLUNTVi1pbXBvcnQubGFiZWxzLnRhYlwiLCB2YWx1ZTogXCJcXHRcIiB9XHJcbiAgICAgICAgXTtcclxuXHJcbiAgICAgICAgaWYgKCEkc2NvcGUudXBsb2FkZXIpIHtcclxuICAgICAgICAgICAgLy8gY3JlYXRlIHRoZSB1cGxvYWRlclxyXG4gICAgICAgICAgICB2YXIgdXBsb2FkZXIgPSAkc2NvcGUudXBsb2FkZXIgPSBuZXcgRmlsZVVwbG9hZGVyKHtcclxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7IEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXHJcbiAgICAgICAgICAgICAgICB1cmw6ICdhcGkvcGxhdGZvcm0vYXNzZXRzP2ZvbGRlclVybD10bXAnLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgICAgICBhdXRvVXBsb2FkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgcmVtb3ZlQWZ0ZXJVcGxvYWQ6IHRydWVcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBBRERJTkcgRklMVEVSUzogY3N2IG9ubHlcclxuICAgICAgICAgICAgLy91cGxvYWRlci5maWx0ZXJzLnB1c2goe1xyXG4gICAgICAgICAgICAvLyAgICBuYW1lOiAnY3N2RmlsdGVyJyxcclxuICAgICAgICAgICAgLy8gICAgZm46IGZ1bmN0aW9uIChpIC8qe0ZpbGV8RmlsZUxpa2VPYmplY3R9Ki8sIG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgIHZhciB0eXBlID0gJ3wnICsgaS50eXBlLnNsaWNlKGkudHlwZS5sYXN0SW5kZXhPZignLycpICsgMSkgKyAnfCc7XHJcbiAgICAgICAgICAgIC8vICAgICAgICByZXR1cm4gJ3xjc3Z8dm5kLm1zLWV4Y2VsfCcuaW5kZXhPZih0eXBlKSAhPT0gLTE7XHJcbiAgICAgICAgICAgIC8vICAgIH1cclxuICAgICAgICAgICAgLy99KTtcclxuXHJcbiAgICAgICAgICAgIHVwbG9hZGVyLm9uQmVmb3JlVXBsb2FkSXRlbSA9IGZ1bmN0aW9uIChmaWxlSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgYmxhZGUuaXNMb2FkaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHVwbG9hZGVyLm9uU3VjY2Vzc0l0ZW0gPSBmdW5jdGlvbiAoZmlsZUl0ZW0sIGFzc2V0LCBzdGF0dXMsIGhlYWRlcnMpIHtcclxuICAgICAgICAgICAgICAgIGJsYWRlLmNzdkZpbGVVcmwgPSBhc3NldFswXS5yZWxhdGl2ZVVybDtcclxuXHJcbiAgICAgICAgICAgICAgICBpbXBvcnRSZXNvdXJjZS5nZXRNYXBwaW5nQ29uZmlndXJhdGlvbih7IGZpbGVVcmw6IGJsYWRlLmNzdkZpbGVVcmwsIGRlbGltaXRlcjogZW5jb2RlVVJJQ29tcG9uZW50KGJsYWRlLmNvbHVtbkRlbGltaXRlcikgfSwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJGxvY2FsU3RvcmFnZS5sYXN0S25vd25JbXBvcnREYXRhICYmICRsb2NhbFN0b3JhZ2UubGFzdEtub3duSW1wb3J0RGF0YS5lVGFnID09PSBkYXRhLmVUYWcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoZGF0YSwgJGxvY2FsU3RvcmFnZS5sYXN0S25vd25JbXBvcnREYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJsYWRlLmltcG9ydENvbmZpZ3VyYXRpb24gPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIGJsYWRlLmlzTG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmxhZGVOYXZpZ2F0aW9uU2VydmljZS5zZXRFcnJvcignRXJyb3IgJyArIGVycm9yLnN0YXR1cywgYmxhZGUpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB1cGxvYWRlci5vbkFmdGVyQWRkaW5nQWxsID0gZnVuY3Rpb24gKGFkZGVkSXRlbXMpIHtcclxuICAgICAgICAgICAgICAgIGJsYWRlTmF2aWdhdGlvblNlcnZpY2Uuc2V0RXJyb3IobnVsbCwgYmxhZGUpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdXBsb2FkZXIub25FcnJvckl0ZW0gPSBmdW5jdGlvbiAoaXRlbSwgcmVzcG9uc2UsIHN0YXR1cywgaGVhZGVycykge1xyXG4gICAgICAgICAgICAgICAgYmxhZGVOYXZpZ2F0aW9uU2VydmljZS5zZXRFcnJvcihpdGVtLl9maWxlLm5hbWUgKyAnIGZhaWxlZDogJyArIChyZXNwb25zZS5tZXNzYWdlID8gcmVzcG9uc2UubWVzc2FnZSA6IHN0YXR1cyksIGJsYWRlKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuY2FuTWFwQ29sdW1ucyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGJsYWRlLmltcG9ydENvbmZpZ3VyYXRpb24gJiYgJHNjb3BlLmZvcm1TY29wZSAmJiAkc2NvcGUuZm9ybVNjb3BlLiR2YWxpZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS5vcGVuTWFwcGluZ1N0ZXAgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBuZXdCbGFkZSA9IHtcclxuICAgICAgICAgICAgICAgIGlkOiBcImltcG9ydE1hcHBpbmdcIixcclxuICAgICAgICAgICAgICAgIGltcG9ydENvbmZpZ3VyYXRpb246IGJsYWRlLmltcG9ydENvbmZpZ3VyYXRpb24sXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogJ2NhdGFsb2dDc3ZJbXBvcnRNb2R1bGUud2l6YXJkcy5jYXRhbG9nLUNTVi1pbXBvcnQtd2l6YXJkLW1hcHBpbmctc3RlcC50aXRsZScsXHJcbiAgICAgICAgICAgICAgICBzdWJ0aXRsZTogJ2NhdGFsb2dDc3ZJbXBvcnRNb2R1bGUud2l6YXJkcy5jYXRhbG9nLUNTVi1pbXBvcnQtd2l6YXJkLW1hcHBpbmctc3RlcC5zdWJ0aXRsZScsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAndmlydG9Db21tZXJjZS5jYXRhbG9nQ3N2SW1wb3J0TW9kdWxlLmNhdGFsb2dDU1ZpbXBvcnRXaXphcmRNYXBwaW5nU3RlcENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICdNb2R1bGVzLyQoVmlydG9Db21tZXJjZS5DYXRhbG9nQ3N2SW1wb3J0TW9kdWxlKS9TY3JpcHRzL2JsYWRlcy9pbXBvcnQvd2l6YXJkL2NhdGFsb2ctQ1NWLWltcG9ydC13aXphcmQtbWFwcGluZy1zdGVwLnRwbC5odG1sJ1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgYmxhZGUuY2FuSW1wb3J0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgYmxhZGVOYXZpZ2F0aW9uU2VydmljZS5zaG93QmxhZGUobmV3QmxhZGUsIGJsYWRlKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuc3RhcnRJbXBvcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRsb2NhbFN0b3JhZ2UubGFzdEtub3duSW1wb3J0RGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIGVUYWc6IGJsYWRlLmltcG9ydENvbmZpZ3VyYXRpb24uZVRhZyxcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5TWFwczogYmxhZGUuaW1wb3J0Q29uZmlndXJhdGlvbi5wcm9wZXJ0eU1hcHMsXHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eUNzdkNvbHVtbnM6IGJsYWRlLmltcG9ydENvbmZpZ3VyYXRpb24ucHJvcGVydHlDc3ZDb2x1bW5zXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB2YXIgZXhwb3J0SW5mbyA9IHsgY29uZmlndXJhdGlvbjogYmxhZGUuaW1wb3J0Q29uZmlndXJhdGlvbiwgZmlsZVVybDogYmxhZGUuY3N2RmlsZVVybCwgY2F0YWxvZ0lkOiBibGFkZS5jYXRhbG9nLmlkIH07XHJcbiAgICAgICAgICAgIGltcG9ydFJlc291cmNlLnJ1bihleHBvcnRJbmZvLCBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3QmxhZGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IFwiaW1wb3J0UHJvZ3Jlc3NcIixcclxuICAgICAgICAgICAgICAgICAgICBjYXRhbG9nOiBibGFkZS5jYXRhbG9nLFxyXG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbjogbm90aWZpY2F0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIGltcG9ydENvbmZpZ3VyYXRpb246IGJsYWRlLmltcG9ydENvbmZpZ3VyYXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3ZpcnRvQ29tbWVyY2UuY2F0YWxvZ0NzdkltcG9ydE1vZHVsZS5jYXRhbG9nQ1NWaW1wb3J0Q29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6ICdNb2R1bGVzLyQoVmlydG9Db21tZXJjZS5DYXRhbG9nQ3N2SW1wb3J0TW9kdWxlKS9TY3JpcHRzL2JsYWRlcy9pbXBvcnQvY2F0YWxvZy1DU1YtaW1wb3J0LnRwbC5odG1sJ1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJG9uKFwibmV3LW5vdGlmaWNhdGlvbi1ldmVudFwiLCBmdW5jdGlvbiAoZXZlbnQsIG5vdGlmaWNhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24gJiYgbm90aWZpY2F0aW9uLmlkID09IG5ld0JsYWRlLm5vdGlmaWNhdGlvbi5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBibGFkZS5jYW5JbXBvcnQgPSBub3RpZmljYXRpb24uZmluaXNoZWQgIT0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBibGFkZS5jYW5JbXBvcnQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGJsYWRlTmF2aWdhdGlvblNlcnZpY2Uuc2hvd0JsYWRlKG5ld0JsYWRlLCBibGFkZSk7XHJcblxyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGJsYWRlTmF2aWdhdGlvblNlcnZpY2Uuc2V0RXJyb3IoJ0Vycm9yICcgKyBlcnJvci5zdGF0dXMsIGJsYWRlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnNldEZvcm0gPSBmdW5jdGlvbiAoZm9ybSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9ybVNjb3BlID0gZm9ybTtcclxuICAgICAgICB9O1xyXG5cclxuICAgIH1dKTtcclxuIiwi77u/YW5ndWxhci5tb2R1bGUoJ3ZpcnRvQ29tbWVyY2UuY2F0YWxvZ0NzdkltcG9ydE1vZHVsZScpXHJcbi5mYWN0b3J5KCd2aXJ0b0NvbW1lcmNlLmNhdGFsb2dDc3ZJbXBvcnRNb2R1bGUuZXhwb3J0JywgWyckcmVzb3VyY2UnLCBmdW5jdGlvbiAoJHJlc291cmNlKSB7XHJcblxyXG4gICAgcmV0dXJuICRyZXNvdXJjZSgnYXBpL2NhdGFsb2djc3ZpbXBvcnQvZXhwb3J0LzppZCcsIHsgaWQ6ICdAaWQnIH0sIHtcclxuICAgICAgICBydW46IHsgbWV0aG9kOiAnUE9TVCcsIHVybDogJ2FwaS9jYXRhbG9nY3N2aW1wb3J0L2V4cG9ydCcsIGlzQXJyYXk6IGZhbHNlIH1cclxuICAgIH0pO1xyXG5cclxufV0pOyIsIu+7v2FuZ3VsYXIubW9kdWxlKCd2aXJ0b0NvbW1lcmNlLmNhdGFsb2dDc3ZJbXBvcnRNb2R1bGUnKVxyXG4uZmFjdG9yeSgndmlydG9Db21tZXJjZS5jYXRhbG9nQ3N2SW1wb3J0TW9kdWxlLmltcG9ydCcsIFsnJHJlc291cmNlJywgZnVuY3Rpb24gKCRyZXNvdXJjZSkge1xyXG5cclxuICAgIHJldHVybiAkcmVzb3VyY2UoJ2FwaS9jYXRhbG9nY3N2aW1wb3J0L2ltcG9ydCcsIHt9LCB7XHJcbiAgICAgICAgZ2V0TWFwcGluZ0NvbmZpZ3VyYXRpb246IHsgbWV0aG9kOiAnR0VUJywgdXJsOiAnYXBpL2NhdGFsb2djc3ZpbXBvcnQvaW1wb3J0L21hcHBpbmdjb25maWd1cmF0aW9uJywgaXNBcnJheTogZmFsc2UgfSxcclxuICAgICAgICBydW46IHsgbWV0aG9kOiAnUE9TVCcsIHVybDogJ2FwaS9jYXRhbG9nY3N2aW1wb3J0L2ltcG9ydCcsIGlzQXJyYXk6IGZhbHNlIH1cclxuXHR9KTtcclxuXHJcbn1dKTsiLCLvu79hbmd1bGFyLm1vZHVsZSgndmlydG9Db21tZXJjZS5jYXRhbG9nQ3N2SW1wb3J0TW9kdWxlJylcclxuLmZhY3RvcnkoJ3ZpcnRvQ29tbWVyY2UuY2F0YWxvZ0NzdkltcG9ydE1vZHVsZS5XZWJBcGknLCBbJyRyZXNvdXJjZScsIGZ1bmN0aW9uICgkcmVzb3VyY2UpIHtcclxuICAgIHJldHVybiAkcmVzb3VyY2UoJ2FwaS9jYXRhbG9nY3N2aW1wb3J0Jyk7XHJcbn1dKTtcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==